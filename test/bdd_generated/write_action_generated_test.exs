# Generated by bdd_compiler from /home/wangbo/document/gong/docs/bdd/write_action.dsl. DO NOT EDIT.

defmodule Gong.BDD.Generated.WriteActionTest do
  use ExUnit.Case, async: false

  @moduletag :bdd_generated

  # Source: BDD-WRITE-001
  @tag :external_io
  @tag :unit
  test "[BDD-WRITE-001] 创建新文件" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BDD-WRITE-001"}
    # line 7: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 7, raw: "GIVEN create_temp_dir"}, 7)
    # line 8: WHEN tool_write path="hello.txt" content="hello world"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_write, %{content: "hello world", path: "hello.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 8, raw: "WHEN tool_write path=\"hello.txt\" content=\"hello world\""}, 8)
    # line 9: THEN assert_tool_success
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_success, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 9, raw: "THEN assert_tool_success"}, 9)
    # line 10: THEN assert_file_exists path="hello.txt"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_exists, %{path: "hello.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 10, raw: "THEN assert_file_exists path=\"hello.txt\""}, 10)
    # line 11: THEN assert_file_content path="hello.txt" expected="hello world"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_content, %{expected: "hello world", path: "hello.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 11, raw: "THEN assert_file_content path=\"hello.txt\" expected=\"hello world\""}, 11)
    _ctx = ctx
    :ok
  end

  # Source: BDD-WRITE-002
  @tag :external_io
  @tag :unit
  test "[BDD-WRITE-002] 覆写已有文件" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BDD-WRITE-002"}
    # line 14: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 14, raw: "GIVEN create_temp_dir"}, 14)
    # line 15: GIVEN create_temp_file path="old.txt" content="old content"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_file, %{content: "old content", path: "old.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 15, raw: "GIVEN create_temp_file path=\"old.txt\" content=\"old content\""}, 15)
    # line 16: WHEN tool_write path="old.txt" content="new content"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_write, %{content: "new content", path: "old.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 16, raw: "WHEN tool_write path=\"old.txt\" content=\"new content\""}, 16)
    # line 17: THEN assert_tool_success
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_success, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 17, raw: "THEN assert_tool_success"}, 17)
    # line 18: THEN assert_file_content path="old.txt" expected="new content"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_content, %{expected: "new content", path: "old.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 18, raw: "THEN assert_file_content path=\"old.txt\" expected=\"new content\""}, 18)
    _ctx = ctx
    :ok
  end

  # Source: BDD-WRITE-003
  @tag :external_io
  @tag :unit
  test "[BDD-WRITE-003] 递归创建父目录" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BDD-WRITE-003"}
    # line 21: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 21, raw: "GIVEN create_temp_dir"}, 21)
    # line 22: WHEN tool_write path="nested/deep/dir/test.txt" content="deep write"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_write, %{content: "deep write", path: "nested/deep/dir/test.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 22, raw: "WHEN tool_write path=\"nested/deep/dir/test.txt\" content=\"deep write\""}, 22)
    # line 23: THEN assert_tool_success
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_success, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 23, raw: "THEN assert_tool_success"}, 23)
    # line 24: THEN assert_file_exists path="nested/deep/dir/test.txt"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_exists, %{path: "nested/deep/dir/test.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 24, raw: "THEN assert_file_exists path=\"nested/deep/dir/test.txt\""}, 24)
    # line 25: THEN assert_file_content path="nested/deep/dir/test.txt" expected="deep write"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_content, %{expected: "deep write", path: "nested/deep/dir/test.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 25, raw: "THEN assert_file_content path=\"nested/deep/dir/test.txt\" expected=\"deep write\""}, 25)
    _ctx = ctx
    :ok
  end

  # Source: BDD-WRITE-004
  @tag :external_io
  @tag :unit
  test "[BDD-WRITE-004] 空内容" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BDD-WRITE-004"}
    # line 30: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 30, raw: "GIVEN create_temp_dir"}, 30)
    # line 31: WHEN tool_write path="empty.txt" content=""
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_write, %{content: "", path: "empty.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 31, raw: "WHEN tool_write path=\"empty.txt\" content=\"\""}, 31)
    # line 32: THEN assert_tool_success
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_success, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 32, raw: "THEN assert_tool_success"}, 32)
    # line 33: THEN assert_file_exists path="empty.txt"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_exists, %{path: "empty.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 33, raw: "THEN assert_file_exists path=\"empty.txt\""}, 33)
    _ctx = ctx
    :ok
  end

  # Source: BDD-WRITE-005
  @tag :external_io
  @tag :unit
  test "[BDD-WRITE-005]" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BDD-WRITE-005"}
    # line 36: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 36, raw: "GIVEN create_temp_dir"}, 36)
    # line 37: WHEN tool_write path="utf8.txt" content="你好世界"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_write, %{content: "你好世界", path: "utf8.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 37, raw: "WHEN tool_write path=\"utf8.txt\" content=\"你好世界\""}, 37)
    # line 38: THEN assert_tool_success
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_success, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 38, raw: "THEN assert_tool_success"}, 38)
    # line 39: THEN assert_file_content path="utf8.txt" expected="你好世界"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_content, %{expected: "你好世界", path: "utf8.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 39, raw: "THEN assert_file_content path=\"utf8.txt\" expected=\"你好世界\""}, 39)
    _ctx = ctx
    :ok
  end

  # Source: BDD-WRITE-006
  @tag :external_io
  @tag :unit
  test "[BDD-WRITE-006] 目标是目录" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BDD-WRITE-006"}
    # line 44: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 44, raw: "GIVEN create_temp_dir"}, 44)
    # line 45: WHEN tool_write path="" content="test"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_write, %{content: "test", path: ""}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 45, raw: "WHEN tool_write path=\"\" content=\"test\""}, 45)
    # line 46: THEN assert_tool_error error_contains="directory"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_error, %{error_contains: "directory"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 46, raw: "THEN assert_tool_error error_contains=\"directory\""}, 46)
    _ctx = ctx
    :ok
  end

  # Source: BDD-WRITE-007
  @tag :external_io
  @tag :unit
  test "[BDD-WRITE-007] 权限不足的目录" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BDD-WRITE-007"}
    # line 49: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 49, raw: "GIVEN create_temp_dir"}, 49)
    # line 50: GIVEN create_temp_file path="readonly_dir/placeholder.txt" content=""
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_file, %{content: "", path: "readonly_dir/placeholder.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 50, raw: "GIVEN create_temp_file path=\"readonly_dir/placeholder.txt\" content=\"\""}, 50)
    # line 51: GIVEN set_file_permission path="readonly_dir" mode="555"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :set_file_permission, %{mode: "555", path: "readonly_dir"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 51, raw: "GIVEN set_file_permission path=\"readonly_dir\" mode=\"555\""}, 51)
    # line 52: WHEN tool_write path="readonly_dir/new_file.txt" content="test"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_write, %{content: "test", path: "readonly_dir/new_file.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 52, raw: "WHEN tool_write path=\"readonly_dir/new_file.txt\" content=\"test\""}, 52)
    # line 53: THEN assert_tool_error error_contains="denied"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_error, %{error_contains: "denied"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 53, raw: "THEN assert_tool_error error_contains=\"denied\""}, 53)
    _ctx = ctx
    :ok
  end

  # Source: BDD-WRITE-008
  @tag :external_io
  @tag :unit
  test "[BDD-WRITE-008] tilde 路径展开" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BDD-WRITE-008"}
    # line 56: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 56, raw: "GIVEN create_temp_dir"}, 56)
    # line 57: WHEN tool_write path="tilde_test.txt" content="tilde works"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_write, %{content: "tilde works", path: "tilde_test.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 57, raw: "WHEN tool_write path=\"tilde_test.txt\" content=\"tilde works\""}, 57)
    # line 58: THEN assert_tool_success
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_success, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 58, raw: "THEN assert_tool_success"}, 58)
    _ctx = ctx
    :ok
  end

  # Source: BDD-WRITE-009
  @tag :external_io
  @tag :unit
  test "[BDD-WRITE-009] 返回字节数" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BDD-WRITE-009"}
    # line 61: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 61, raw: "GIVEN create_temp_dir"}, 61)
    # line 62: WHEN tool_write path="bytes.txt" content="12345"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_write, %{content: "12345", path: "bytes.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 62, raw: "WHEN tool_write path=\"bytes.txt\" content=\"12345\""}, 62)
    # line 63: THEN assert_tool_success
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_success, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 63, raw: "THEN assert_tool_success"}, 63)
    # line 64: THEN assert_result_field field="bytes_written" expected="5"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_result_field, %{expected: "5", field: "bytes_written"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 64, raw: "THEN assert_result_field field=\"bytes_written\" expected=\"5\""}, 64)
    _ctx = ctx
    :ok
  end

end
