# Generated by bdd_compiler from /home/wangbo/document/gong/docs/bdd/write_action.dsl. DO NOT EDIT.

defmodule Gong.BDD.Generated.WriteActionTest do
  use ExUnit.Case, async: false

  @moduletag :bdd_generated

  # Source: BDD-WRITE-001
  @tag :external_io
  @tag :unit
  test "[BDD-WRITE-001] 创建新文件" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BDD-WRITE-001"}
    # line 7: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 7, raw: "GIVEN create_temp_dir"}, 7)
    # line 8: WHEN tool_write path="hello.txt" content="hello world"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_write, %{content: "hello world", path: "hello.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 8, raw: "WHEN tool_write path=\"hello.txt\" content=\"hello world\""}, 8)
    # line 9: THEN assert_tool_success
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_success, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 9, raw: "THEN assert_tool_success"}, 9)
    # line 10: THEN assert_file_exists path="hello.txt"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_exists, %{path: "hello.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 10, raw: "THEN assert_file_exists path=\"hello.txt\""}, 10)
    # line 11: THEN assert_file_content path="hello.txt" expected="hello world"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_content, %{expected: "hello world", path: "hello.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 11, raw: "THEN assert_file_content path=\"hello.txt\" expected=\"hello world\""}, 11)
    _ctx = ctx
    :ok
  end

  # Source: BDD-WRITE-002
  @tag :external_io
  @tag :unit
  test "[BDD-WRITE-002] 覆写已有文件" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BDD-WRITE-002"}
    # line 14: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 14, raw: "GIVEN create_temp_dir"}, 14)
    # line 15: GIVEN create_temp_file path="old.txt" content="old content"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_file, %{content: "old content", path: "old.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 15, raw: "GIVEN create_temp_file path=\"old.txt\" content=\"old content\""}, 15)
    # line 16: WHEN tool_write path="old.txt" content="new content"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_write, %{content: "new content", path: "old.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 16, raw: "WHEN tool_write path=\"old.txt\" content=\"new content\""}, 16)
    # line 17: THEN assert_tool_success
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_success, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 17, raw: "THEN assert_tool_success"}, 17)
    # line 18: THEN assert_file_content path="old.txt" expected="new content"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_content, %{expected: "new content", path: "old.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 18, raw: "THEN assert_file_content path=\"old.txt\" expected=\"new content\""}, 18)
    _ctx = ctx
    :ok
  end

  # Source: BDD-WRITE-003
  @tag :external_io
  @tag :unit
  test "[BDD-WRITE-003] 递归创建父目录" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BDD-WRITE-003"}
    # line 21: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 21, raw: "GIVEN create_temp_dir"}, 21)
    # line 22: WHEN tool_write path="nested/deep/dir/test.txt" content="deep write"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_write, %{content: "deep write", path: "nested/deep/dir/test.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 22, raw: "WHEN tool_write path=\"nested/deep/dir/test.txt\" content=\"deep write\""}, 22)
    # line 23: THEN assert_tool_success
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_success, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 23, raw: "THEN assert_tool_success"}, 23)
    # line 24: THEN assert_file_exists path="nested/deep/dir/test.txt"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_exists, %{path: "nested/deep/dir/test.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 24, raw: "THEN assert_file_exists path=\"nested/deep/dir/test.txt\""}, 24)
    # line 25: THEN assert_file_content path="nested/deep/dir/test.txt" expected="deep write"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_content, %{expected: "deep write", path: "nested/deep/dir/test.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 25, raw: "THEN assert_file_content path=\"nested/deep/dir/test.txt\" expected=\"deep write\""}, 25)
    _ctx = ctx
    :ok
  end

  # Source: BDD-WRITE-004
  @tag :external_io
  @tag :unit
  test "[BDD-WRITE-004] 空内容" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BDD-WRITE-004"}
    # line 30: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 30, raw: "GIVEN create_temp_dir"}, 30)
    # line 31: WHEN tool_write path="empty.txt" content=""
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_write, %{content: "", path: "empty.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 31, raw: "WHEN tool_write path=\"empty.txt\" content=\"\""}, 31)
    # line 32: THEN assert_tool_success
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_success, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 32, raw: "THEN assert_tool_success"}, 32)
    # line 33: THEN assert_file_exists path="empty.txt"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_exists, %{path: "empty.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 33, raw: "THEN assert_file_exists path=\"empty.txt\""}, 33)
    # line 34: THEN assert_file_content path="empty.txt" expected=""
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_content, %{expected: "", path: "empty.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 34, raw: "THEN assert_file_content path=\"empty.txt\" expected=\"\""}, 34)
    _ctx = ctx
    :ok
  end

  # Source: BDD-WRITE-005
  @tag :external_io
  @tag :unit
  test "[BDD-WRITE-005]" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BDD-WRITE-005"}
    # line 37: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 37, raw: "GIVEN create_temp_dir"}, 37)
    # line 38: WHEN tool_write path="utf8.txt" content="你好世界"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_write, %{content: "你好世界", path: "utf8.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 38, raw: "WHEN tool_write path=\"utf8.txt\" content=\"你好世界\""}, 38)
    # line 39: THEN assert_tool_success
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_success, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 39, raw: "THEN assert_tool_success"}, 39)
    # line 40: THEN assert_file_content path="utf8.txt" expected="你好世界"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_content, %{expected: "你好世界", path: "utf8.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 40, raw: "THEN assert_file_content path=\"utf8.txt\" expected=\"你好世界\""}, 40)
    _ctx = ctx
    :ok
  end

  # Source: BDD-WRITE-006
  @tag :external_io
  @tag :unit
  test "[BDD-WRITE-006] 目标是目录" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BDD-WRITE-006"}
    # line 45: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 45, raw: "GIVEN create_temp_dir"}, 45)
    # line 46: GIVEN create_temp_file path="subdir/placeholder.txt" content=""
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_file, %{content: "", path: "subdir/placeholder.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 46, raw: "GIVEN create_temp_file path=\"subdir/placeholder.txt\" content=\"\""}, 46)
    # line 47: WHEN tool_write path="subdir" content="test"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_write, %{content: "test", path: "subdir"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 47, raw: "WHEN tool_write path=\"subdir\" content=\"test\""}, 47)
    # line 48: THEN assert_tool_error error_contains="Is a directory"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_error, %{error_contains: "Is a directory"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 48, raw: "THEN assert_tool_error error_contains=\"Is a directory\""}, 48)
    _ctx = ctx
    :ok
  end

  # Source: BDD-WRITE-007
  @tag :external_io
  @tag :unit
  test "[BDD-WRITE-007] 权限不足的目录" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BDD-WRITE-007"}
    # line 51: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 51, raw: "GIVEN create_temp_dir"}, 51)
    # line 52: GIVEN create_temp_file path="readonly_dir/placeholder.txt" content=""
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_file, %{content: "", path: "readonly_dir/placeholder.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 52, raw: "GIVEN create_temp_file path=\"readonly_dir/placeholder.txt\" content=\"\""}, 52)
    # line 53: GIVEN set_file_permission path="readonly_dir" mode="555"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :set_file_permission, %{mode: "555", path: "readonly_dir"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 53, raw: "GIVEN set_file_permission path=\"readonly_dir\" mode=\"555\""}, 53)
    # line 54: WHEN tool_write path="readonly_dir/new_file.txt" content="test"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_write, %{content: "test", path: "readonly_dir/new_file.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 54, raw: "WHEN tool_write path=\"readonly_dir/new_file.txt\" content=\"test\""}, 54)
    # line 55: THEN assert_tool_error error_contains="denied"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_error, %{error_contains: "denied"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 55, raw: "THEN assert_tool_error error_contains=\"denied\""}, 55)
    _ctx = ctx
    :ok
  end

  # Source: BDD-WRITE-008
  @tag :external_io
  @tag :unit
  test "[BDD-WRITE-008] tilde 路径展开" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BDD-WRITE-008"}
    # line 58: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 58, raw: "GIVEN create_temp_dir"}, 58)
    # line 59: WHEN tool_write path="tilde_test.txt" content="tilde works"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_write, %{content: "tilde works", path: "tilde_test.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 59, raw: "WHEN tool_write path=\"tilde_test.txt\" content=\"tilde works\""}, 59)
    # line 60: THEN assert_tool_success
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_success, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 60, raw: "THEN assert_tool_success"}, 60)
    # line 61: THEN assert_file_content path="tilde_test.txt" expected="tilde works"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_content, %{expected: "tilde works", path: "tilde_test.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 61, raw: "THEN assert_file_content path=\"tilde_test.txt\" expected=\"tilde works\""}, 61)
    _ctx = ctx
    :ok
  end

  # Source: BDD-WRITE-009
  @tag :external_io
  @tag :unit
  test "[BDD-WRITE-009] 返回字节数" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BDD-WRITE-009"}
    # line 64: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 64, raw: "GIVEN create_temp_dir"}, 64)
    # line 65: WHEN tool_write path="bytes.txt" content="12345"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_write, %{content: "12345", path: "bytes.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 65, raw: "WHEN tool_write path=\"bytes.txt\" content=\"12345\""}, 65)
    # line 66: THEN assert_tool_success
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_success, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 66, raw: "THEN assert_tool_success"}, 66)
    # line 67: THEN assert_result_field field="bytes_written" expected="5"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_result_field, %{expected: "5", field: "bytes_written"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 67, raw: "THEN assert_result_field field=\"bytes_written\" expected=\"5\""}, 67)
    _ctx = ctx
    :ok
  end

  # Source: BDD-WRITE-010
  @tag :external_io
  @tag :unit
  test "[BDD-WRITE-010] 符号链接覆写" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BDD-WRITE-010"}
    # line 72: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 72, raw: "GIVEN create_temp_dir"}, 72)
    # line 73: GIVEN create_temp_file path="real.txt" content="original"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_file, %{content: "original", path: "real.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 73, raw: "GIVEN create_temp_file path=\"real.txt\" content=\"original\""}, 73)
    # line 74: GIVEN create_symlink link="link.txt" target="real.txt"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_symlink, %{link: "link.txt", target: "real.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 74, raw: "GIVEN create_symlink link=\"link.txt\" target=\"real.txt\""}, 74)
    # line 75: WHEN tool_write path="link.txt" content="via symlink"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_write, %{content: "via symlink", path: "link.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 75, raw: "WHEN tool_write path=\"link.txt\" content=\"via symlink\""}, 75)
    # line 76: THEN assert_tool_success
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_success, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 76, raw: "THEN assert_tool_success"}, 76)
    # line 77: THEN assert_file_content path="real.txt" expected="via symlink"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_content, %{expected: "via symlink", path: "real.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 77, raw: "THEN assert_file_content path=\"real.txt\" expected=\"via symlink\""}, 77)
    _ctx = ctx
    :ok
  end

  # Source: BDD-WRITE-011
  @tag :external_io
  @tag :unit
  test "[BDD-WRITE-011]" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BDD-WRITE-011"}
    # line 80: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 80, raw: "GIVEN create_temp_dir"}, 80)
    # line 81: WHEN tool_write path="utf8_bytes.txt" content="你好"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_write, %{content: "你好", path: "utf8_bytes.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 81, raw: "WHEN tool_write path=\"utf8_bytes.txt\" content=\"你好\""}, 81)
    # line 82: THEN assert_tool_success
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_success, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 82, raw: "THEN assert_tool_success"}, 82)
    # line 83: THEN assert_result_field field="bytes_written" expected="6"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_result_field, %{expected: "6", field: "bytes_written"}, %{file: "/home/wangbo/document/gong/docs/bdd/write_action.dsl", line: 83, raw: "THEN assert_result_field field=\"bytes_written\" expected=\"6\""}, 83)
    _ctx = ctx
    :ok
  end

end
