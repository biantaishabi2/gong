# Generated by bdd_compiler from /home/wangbo/document/gong/docs/bdd/config_edge.dsl. DO NOT EDIT.

defmodule Gong.BDD.Generated.ConfigEdgeTest do
  use ExUnit.Case, async: false

  @moduletag :bdd_generated

  # Source: CONFIG-ERR-001
  @tag :config
  @tag :unit
  test "[CONFIG-ERR-001] 部分字段缺失时用默认值" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "CONFIG-ERR-001"}
    # line 9: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 9, raw: "GIVEN create_temp_dir"}, 9)
    # line 10: GIVEN init_model_registry
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :init_model_registry, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 10, raw: "GIVEN init_model_registry"}, 10)
    # line 11: GIVEN register_model_with_defaults name="minimal" provider="openai" model_id="gpt-4"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :register_model_with_defaults, %{model_id: "gpt-4", name: "minimal", provider: "openai"}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 11, raw: "GIVEN register_model_with_defaults name=\"minimal\" provider=\"openai\" model_id=\"gpt-4\""}, 11)
    # line 12: THEN assert_context_window_size name="minimal" expected=128000
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_context_window_size, %{expected: 128000, name: "minimal"}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 12, raw: "THEN assert_context_window_size name=\"minimal\" expected=128000"}, 12)
    _ctx = ctx
    :ok
  end

  # Source: CONFIG-ERR-002
  @tag :config
  @tag :unit
  test "[CONFIG-ERR-002] 配置热重载" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "CONFIG-ERR-002"}
    # line 15: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 15, raw: "GIVEN create_temp_dir"}, 15)
    # line 16: GIVEN init_settings
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :init_settings, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 16, raw: "GIVEN init_settings"}, 16)
    # line 17: GIVEN create_settings_file scope="project" content="{\"temperature\": \"0.7\"}"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_settings_file, %{content: "{\\\"temperature\\\": \\\"0.7\\\"}", scope: "project"}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 17, raw: "GIVEN create_settings_file scope=\"project\" content=\"{\\\"temperature\\\": \\\"0.7\\\"}\""}, 17)
    # line 18: WHEN reload_settings
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :reload_settings, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 18, raw: "WHEN reload_settings"}, 18)
    # line 19: THEN assert_setting_value key="temperature" expected="0.7"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_setting_value, %{expected: "0.7", key: "temperature"}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 19, raw: "THEN assert_setting_value key=\"temperature\" expected=\"0.7\""}, 19)
    _ctx = ctx
    :ok
  end

  # Source: CONFIG-ERR-003
  @tag :config
  @tag :unit
  test "[CONFIG-ERR-003] 空数组配置的语义正确" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "CONFIG-ERR-003"}
    # line 22: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 22, raw: "GIVEN create_temp_dir"}, 22)
    # line 23: GIVEN init_settings
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :init_settings, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 23, raw: "GIVEN init_settings"}, 23)
    # line 24: GIVEN set_config_empty_array key="allowed_tools"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :set_config_empty_array, %{key: "allowed_tools"}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 24, raw: "GIVEN set_config_empty_array key=\"allowed_tools\""}, 24)
    # line 25: THEN assert_config_blocks_all key="allowed_tools"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_config_blocks_all, %{key: "allowed_tools"}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 25, raw: "THEN assert_config_blocks_all key=\"allowed_tools\""}, 25)
    _ctx = ctx
    :ok
  end

  # Source: CONFIG-ERR-004
  @tag :config
  @tag :unit
  test "[CONFIG-ERR-004] 系统提示词组装完整" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "CONFIG-ERR-004"}
    # line 32: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 32, raw: "GIVEN create_temp_dir"}, 32)
    # line 33: WHEN build_system_prompt
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :build_system_prompt, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 33, raw: "WHEN build_system_prompt"}, 33)
    # line 34: THEN assert_prompt_contains_context
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_prompt_contains_context, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 34, raw: "THEN assert_prompt_contains_context"}, 34)
    # line 35: THEN assert_prompt_contains_time
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_prompt_contains_time, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 35, raw: "THEN assert_prompt_contains_time"}, 35)
    # line 36: THEN assert_prompt_contains_cwd
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_prompt_contains_cwd, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 36, raw: "THEN assert_prompt_contains_cwd"}, 36)
    _ctx = ctx
    :ok
  end

  # Source: CONFIG-ERR-005
  @tag :config
  @tag :unit
  test "[CONFIG-ERR-005] 验证不存在的模型返回错误" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "CONFIG-ERR-005"}
    # line 39: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 39, raw: "GIVEN create_temp_dir"}, 39)
    # line 40: GIVEN init_model_registry
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :init_model_registry, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 40, raw: "GIVEN init_model_registry"}, 40)
    # line 41: WHEN validate_model name="nonexistent_xyz"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :validate_model, %{name: "nonexistent_xyz"}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 41, raw: "WHEN validate_model name=\"nonexistent_xyz\""}, 41)
    # line 42: THEN assert_model_error error_contains="未注册"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_model_error, %{error_contains: "未注册"}, %{file: "/home/wangbo/document/gong/docs/bdd/config_edge.dsl", line: 42, raw: "THEN assert_model_error error_contains=\"未注册\""}, 42)
    _ctx = ctx
    :ok
  end

end
