# Generated by bdd_compiler from /home/wangbo/document/gong/docs/bdd/cross_provider.dsl. DO NOT EDIT.

defmodule Gong.BDD.Generated.CrossProviderTest do
  use ExUnit.Case, async: false

  @moduletag :bdd_generated

  # Source: CROSS-001
  @tag :cross_provider
  @tag :unit
  test "[CROSS-001] 消息格式转换" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "CROSS-001"}
    # line 8: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 8, raw: "GIVEN create_temp_dir"}, 8)
    # line 9: GIVEN cross_provider_messages count=3
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :cross_provider_messages, %{count: 3}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 9, raw: "GIVEN cross_provider_messages count=3"}, 9)
    # line 10: WHEN convert_messages from="deepseek" to="openai"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :convert_messages, %{from: "deepseek", to: "openai"}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 10, raw: "WHEN convert_messages from=\"deepseek\" to=\"openai\""}, 10)
    # line 11: THEN assert_converted_messages count=3
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_converted_messages, %{count: 3}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 11, raw: "THEN assert_converted_messages count=3"}, 11)
    _ctx = ctx
    :ok
  end

  # Source: CROSS-002
  @tag :cross_provider
  @tag :unit
  test "[CROSS-002] 切换摘要构建" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "CROSS-002"}
    # line 14: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 14, raw: "GIVEN create_temp_dir"}, 14)
    # line 15: GIVEN cross_provider_messages count=5
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :cross_provider_messages, %{count: 5}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 15, raw: "GIVEN cross_provider_messages count=5"}, 15)
    # line 16: WHEN build_handoff_summary
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :build_handoff_summary, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 16, raw: "WHEN build_handoff_summary"}, 16)
    # line 17: THEN assert_handoff_summary_not_empty
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_handoff_summary_not_empty, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 17, raw: "THEN assert_handoff_summary_not_empty"}, 17)
    _ctx = ctx
    :ok
  end

  # Source: CROSS-003
  @tag :cross_provider
  @tag :unit
  test "[CROSS-003] 多部分内容规范化" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "CROSS-003"}
    # line 20: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 20, raw: "GIVEN create_temp_dir"}, 20)
    # line 21: GIVEN cross_provider_multipart_message
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :cross_provider_multipart_message, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 21, raw: "GIVEN cross_provider_multipart_message"}, 21)
    # line 22: WHEN convert_messages from="anthropic" to="deepseek"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :convert_messages, %{from: "anthropic", to: "deepseek"}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 22, raw: "WHEN convert_messages from=\"anthropic\" to=\"deepseek\""}, 22)
    # line 23: THEN assert_content_is_text
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_content_is_text, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 23, raw: "THEN assert_content_is_text"}, 23)
    _ctx = ctx
    :ok
  end

  # Source: CMD-001
  @tag :command
  @tag :unit
  test "[CMD-001] 注册并执行自定义命令" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "CMD-001"}
    # line 30: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 30, raw: "GIVEN create_temp_dir"}, 30)
    # line 31: WHEN init_command_registry
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :init_command_registry, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 31, raw: "WHEN init_command_registry"}, 31)
    # line 32: WHEN register_command name="hello" description="打招呼"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :register_command, %{description: "打招呼", name: "hello"}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 32, raw: "WHEN register_command name=\"hello\" description=\"打招呼\""}, 32)
    # line 33: WHEN execute_command name="hello"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :execute_command, %{name: "hello"}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 33, raw: "WHEN execute_command name=\"hello\""}, 33)
    # line 34: THEN assert_command_result contains="hello"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_command_result, %{contains: "hello"}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 34, raw: "THEN assert_command_result contains=\"hello\""}, 34)
    _ctx = ctx
    :ok
  end

  # Source: CMD-002
  @tag :command
  @tag :unit
  test "[CMD-002] 执行不存在的命令" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "CMD-002"}
    # line 37: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 37, raw: "GIVEN create_temp_dir"}, 37)
    # line 38: WHEN init_command_registry
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :init_command_registry, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 38, raw: "WHEN init_command_registry"}, 38)
    # line 39: WHEN execute_command_expect_error name="nonexistent"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :execute_command_expect_error, %{name: "nonexistent"}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 39, raw: "WHEN execute_command_expect_error name=\"nonexistent\""}, 39)
    # line 40: THEN assert_command_error contains="命令不存在"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_command_error, %{contains: "命令不存在"}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 40, raw: "THEN assert_command_error contains=\"命令不存在\""}, 40)
    _ctx = ctx
    :ok
  end

  # Source: CMD-003
  @tag :command
  @tag :unit
  test "[CMD-003] 列出所有命令" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "CMD-003"}
    # line 43: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 43, raw: "GIVEN create_temp_dir"}, 43)
    # line 44: WHEN init_command_registry
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :init_command_registry, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 44, raw: "WHEN init_command_registry"}, 44)
    # line 45: WHEN register_command name="cmd_a" description="命令A"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :register_command, %{description: "命令A", name: "cmd_a"}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 45, raw: "WHEN register_command name=\"cmd_a\" description=\"命令A\""}, 45)
    # line 46: WHEN register_command name="cmd_b" description="命令B"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :register_command, %{description: "命令B", name: "cmd_b"}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 46, raw: "WHEN register_command name=\"cmd_b\" description=\"命令B\""}, 46)
    # line 47: THEN assert_command_count expected=2
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_command_count, %{expected: 2}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 47, raw: "THEN assert_command_count expected=2"}, 47)
    _ctx = ctx
    :ok
  end

  # Source: CMD-004
  @tag :command
  @tag :unit
  test "[CMD-004] 命令存在性检查" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "CMD-004"}
    # line 54: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 54, raw: "GIVEN create_temp_dir"}, 54)
    # line 55: WHEN init_command_registry
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :init_command_registry, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 55, raw: "WHEN init_command_registry"}, 55)
    # line 56: WHEN register_command name="exists_cmd" description="存在检查"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :register_command, %{description: "存在检查", name: "exists_cmd"}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 56, raw: "WHEN register_command name=\"exists_cmd\" description=\"存在检查\""}, 56)
    # line 57: THEN assert_command_exists name="exists_cmd" expected="true"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_command_exists, %{expected: "true", name: "exists_cmd"}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 57, raw: "THEN assert_command_exists name=\"exists_cmd\" expected=\"true\""}, 57)
    # line 58: THEN assert_command_exists name="nonexistent" expected="false"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_command_exists, %{expected: "false", name: "nonexistent"}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 58, raw: "THEN assert_command_exists name=\"nonexistent\" expected=\"false\""}, 58)
    _ctx = ctx
    :ok
  end

  # Source: CROSS-004
  @tag :cross_provider
  @tag :unit
  test "[CROSS-004] 空消息列表转换" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "CROSS-004"}
    # line 61: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 61, raw: "GIVEN create_temp_dir"}, 61)
    # line 62: GIVEN cross_provider_messages count=0
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :cross_provider_messages, %{count: 0}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 62, raw: "GIVEN cross_provider_messages count=0"}, 62)
    # line 63: WHEN convert_messages from="openai" to="deepseek"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :convert_messages, %{from: "openai", to: "deepseek"}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 63, raw: "WHEN convert_messages from=\"openai\" to=\"deepseek\""}, 63)
    # line 64: THEN assert_converted_messages count=0
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_converted_messages, %{count: 0}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 64, raw: "THEN assert_converted_messages count=0"}, 64)
    _ctx = ctx
    :ok
  end

  # Source: CROSS-005
  @tag :cross_provider
  @tag :unit
  test "[CROSS-005] 带 tool_calls 的消息转换" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "CROSS-005"}
    # line 67: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 67, raw: "GIVEN create_temp_dir"}, 67)
    # line 68: GIVEN cross_provider_tool_calls_message
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :cross_provider_tool_calls_message, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 68, raw: "GIVEN cross_provider_tool_calls_message"}, 68)
    # line 69: WHEN convert_messages from="openai" to="anthropic"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :convert_messages, %{from: "openai", to: "anthropic"}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 69, raw: "WHEN convert_messages from=\"openai\" to=\"anthropic\""}, 69)
    # line 70: THEN assert_converted_messages count=1
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_converted_messages, %{count: 1}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 70, raw: "THEN assert_converted_messages count=1"}, 70)
    # line 71: THEN assert_converted_has_tool_calls
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_converted_has_tool_calls, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/cross_provider.dsl", line: 71, raw: "THEN assert_converted_has_tool_calls"}, 71)
    _ctx = ctx
    :ok
  end

end
