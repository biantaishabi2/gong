# Generated by bdd_compiler from /home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl. DO NOT EDIT.

defmodule Gong.BDD.Generated.PromptEngineeringTest do
  use ExUnit.Case, async: false

  @moduletag :bdd_generated

  # Source: PROMPT-001
  @tag :prompt
  @tag :unit
  test "[PROMPT-001] 默认系统提示包含关键指令" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "PROMPT-001"}
    # line 9: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 9, raw: "GIVEN create_temp_dir"}, 9)
    # line 10: WHEN build_default_prompt
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :build_default_prompt, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 10, raw: "WHEN build_default_prompt"}, 10)
    # line 11: THEN assert_prompt_text contains="Gong"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_prompt_text, %{contains: "Gong"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 11, raw: "THEN assert_prompt_text contains=\"Gong\""}, 11)
    # line 12: THEN assert_prompt_text contains="工具"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_prompt_text, %{contains: "工具"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 12, raw: "THEN assert_prompt_text contains=\"工具\""}, 12)
    _ctx = ctx
    :ok
  end

  # Source: PROMPT-002
  @tag :prompt
  @tag :unit
  test "[PROMPT-002] 带工作目录的系统提示" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "PROMPT-002"}
    # line 15: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 15, raw: "GIVEN create_temp_dir"}, 15)
    # line 16: WHEN build_workspace_prompt
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :build_workspace_prompt, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 16, raw: "WHEN build_workspace_prompt"}, 16)
    # line 17: THEN assert_prompt_text contains="工作目录"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_prompt_text, %{contains: "工作目录"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 17, raw: "THEN assert_prompt_text contains=\"工作目录\""}, 17)
    _ctx = ctx
    :ok
  end

  # Source: PROMPT-003
  @tag :prompt
  @tag :unit
  test "[PROMPT-003] 对话格式化截断超长内容" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "PROMPT-003"}
    # line 20: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 20, raw: "GIVEN create_temp_dir"}, 20)
    # line 21: GIVEN prompt_messages_with_long_content length=2000
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :prompt_messages_with_long_content, %{length: 2000}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 21, raw: "GIVEN prompt_messages_with_long_content length=2000"}, 21)
    # line 22: WHEN format_conversation
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :format_conversation, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 22, raw: "WHEN format_conversation"}, 22)
    # line 23: THEN assert_formatted_length max=600
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_formatted_length, %{max: 600}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 23, raw: "THEN assert_formatted_length max=600"}, 23)
    _ctx = ctx
    :ok
  end

  # Source: PROMPT-004
  @tag :prompt
  @tag :unit
  test "[PROMPT-004] 无文件操作时显示提示文本" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "PROMPT-004"}
    # line 30: GIVEN prompt_messages_plain count=3
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :prompt_messages_plain, %{count: 3}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 30, raw: "GIVEN prompt_messages_plain count=3"}, 30)
    # line 31: WHEN extract_prompt_file_ops
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :extract_prompt_file_ops, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 31, raw: "WHEN extract_prompt_file_ops"}, 31)
    # line 32: THEN assert_file_ops_text contains="无文件操作"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_ops_text, %{contains: "无文件操作"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 32, raw: "THEN assert_file_ops_text contains=\"无文件操作\""}, 32)
    _ctx = ctx
    :ok
  end

  # Source: PROMPT-005
  @tag :prompt
  @tag :unit
  test "[PROMPT-005] 多工具调用提取全部文件操作" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "PROMPT-005"}
    # line 35: GIVEN prompt_messages_multi_tools tools="read_file:/a.txt,write_file:/b.txt,edit_file:/c.txt"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :prompt_messages_multi_tools, %{tools: "read_file:/a.txt,write_file:/b.txt,edit_file:/c.txt"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 35, raw: "GIVEN prompt_messages_multi_tools tools=\"read_file:/a.txt,write_file:/b.txt,edit_file:/c.txt\""}, 35)
    # line 36: WHEN extract_prompt_file_ops
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :extract_prompt_file_ops, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 36, raw: "WHEN extract_prompt_file_ops"}, 36)
    # line 37: THEN assert_file_ops_text contains="read_file"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_ops_text, %{contains: "read_file"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 37, raw: "THEN assert_file_ops_text contains=\"read_file\""}, 37)
    # line 38: THEN assert_file_ops_text contains="write_file"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_ops_text, %{contains: "write_file"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 38, raw: "THEN assert_file_ops_text contains=\"write_file\""}, 38)
    # line 39: THEN assert_file_ops_text contains="edit_file"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_file_ops_text, %{contains: "edit_file"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 39, raw: "THEN assert_file_ops_text contains=\"edit_file\""}, 39)
    _ctx = ctx
    :ok
  end

  # Source: PROMPT-006
  @tag :prompt
  @tag :unit
  test "[PROMPT-006] find_previous_summary 定位前次摘要" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "PROMPT-006"}
    # line 42: GIVEN prompt_messages_with_summary summary="Goal: 重构代码"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :prompt_messages_with_summary, %{summary: "Goal: 重构代码"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 42, raw: "GIVEN prompt_messages_with_summary summary=\"Goal: 重构代码\""}, 42)
    # line 43: WHEN find_previous_summary
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :find_previous_summary, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 43, raw: "WHEN find_previous_summary"}, 43)
    # line 44: THEN assert_previous_summary contains="重构代码"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_previous_summary, %{contains: "重构代码"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 44, raw: "THEN assert_previous_summary contains=\"重构代码\""}, 44)
    _ctx = ctx
    :ok
  end

  # Source: PROMPT-007
  @tag :prompt
  @tag :unit
  test "[PROMPT-007] 无前次摘要返回 nil" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "PROMPT-007"}
    # line 47: GIVEN prompt_messages_plain count=3
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :prompt_messages_plain, %{count: 3}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 47, raw: "GIVEN prompt_messages_plain count=3"}, 47)
    # line 48: WHEN find_previous_summary
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :find_previous_summary, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 48, raw: "WHEN find_previous_summary"}, 48)
    # line 49: THEN assert_previous_summary_nil
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_previous_summary_nil, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_engineering.dsl", line: 49, raw: "THEN assert_previous_summary_nil"}, 49)
    _ctx = ctx
    :ok
  end

end
