# Generated by bdd_compiler from /home/wangbo/document/gong/docs/bdd/bash_edge.dsl. DO NOT EDIT.

defmodule Gong.BDD.Generated.BashEdgeTest do
  use ExUnit.Case, async: false

  @moduletag :bdd_generated

  # Source: BASH-ERR-001
  @tag :external_io
  @tag :unit
  test "[BASH-ERR-001]" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BASH-ERR-001"}
    # line 9: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/bash_edge.dsl", line: 9, raw: "GIVEN create_temp_dir"}, 9)
    # line 10: WHEN tool_bash command="head -c 100 /bin/ls"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_bash, %{command: "head -c 100 /bin/ls"}, %{file: "/home/wangbo/document/gong/docs/bdd/bash_edge.dsl", line: 10, raw: "WHEN tool_bash command=\"head -c 100 /bin/ls\""}, 10)
    # line 11: THEN assert_tool_success
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_success, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/bash_edge.dsl", line: 11, raw: "THEN assert_tool_success"}, 11)
    # line 12: THEN assert_result_field field="timed_out" expected="false"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_result_field, %{expected: "false", field: "timed_out"}, %{file: "/home/wangbo/document/gong/docs/bdd/bash_edge.dsl", line: 12, raw: "THEN assert_result_field field=\"timed_out\" expected=\"false\""}, 12)
    _ctx = ctx
    :ok
  end

  # Source: BASH-ERR-002
  @tag :external_io
  @tag :unit
  test "[BASH-ERR-002] 输出截断行数计算精确" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BASH-ERR-002"}
    # line 15: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/bash_edge.dsl", line: 15, raw: "GIVEN create_temp_dir"}, 15)
    # line 16: WHEN tool_bash command="seq 1 5000"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_bash, %{command: "seq 1 5000"}, %{file: "/home/wangbo/document/gong/docs/bdd/bash_edge.dsl", line: 16, raw: "WHEN tool_bash command=\"seq 1 5000\""}, 16)
    # line 17: THEN assert_tool_success
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_success, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/bash_edge.dsl", line: 17, raw: "THEN assert_tool_success"}, 17)
    # line 18: THEN assert_output_contains text="omitted"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_output_contains, %{text: "omitted"}, %{file: "/home/wangbo/document/gong/docs/bdd/bash_edge.dsl", line: 18, raw: "THEN assert_output_contains text=\"omitted\""}, 18)
    # line 19: THEN assert_output_contains text="5000"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_output_contains, %{text: "5000"}, %{file: "/home/wangbo/document/gong/docs/bdd/bash_edge.dsl", line: 19, raw: "THEN assert_output_contains text=\"5000\""}, 19)
    _ctx = ctx
    :ok
  end

  # Source: BASH-ERR-003
  @tag :external_io
  @tag :unit
  test "[BASH-ERR-003] 含 ANSI 转义码的输出正确处理" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BASH-ERR-003"}
    # line 22: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/bash_edge.dsl", line: 22, raw: "GIVEN create_temp_dir"}, 22)
    # line 23: WHEN tool_bash command="printf '\033[31mred\033[0m normal'"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_bash, %{command: "printf '\\033[31mred\\033[0m normal'"}, %{file: "/home/wangbo/document/gong/docs/bdd/bash_edge.dsl", line: 23, raw: "WHEN tool_bash command=\"printf '\\033[31mred\\033[0m normal'\""}, 23)
    # line 24: THEN assert_tool_success content_contains="red"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_tool_success, %{content_contains: "red"}, %{file: "/home/wangbo/document/gong/docs/bdd/bash_edge.dsl", line: 24, raw: "THEN assert_tool_success content_contains=\"red\""}, 24)
    # line 25: THEN assert_output_contains text="normal"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_output_contains, %{text: "normal"}, %{file: "/home/wangbo/document/gong/docs/bdd/bash_edge.dsl", line: 25, raw: "THEN assert_output_contains text=\"normal\""}, 25)
    _ctx = ctx
    :ok
  end

  # Source: BASH-ERR-004
  @tag :external_io
  @tag :unit
  test "[BASH-ERR-004] Abort 时清理后台进程" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "BASH-ERR-004"}
    # line 28: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/bash_edge.dsl", line: 28, raw: "GIVEN create_temp_dir"}, 28)
    # line 29: WHEN tool_bash command="sleep 300 & sleep 300 & wait" timeout=2
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :tool_bash, %{command: "sleep 300 & sleep 300 & wait", timeout: 2}, %{file: "/home/wangbo/document/gong/docs/bdd/bash_edge.dsl", line: 29, raw: "WHEN tool_bash command=\"sleep 300 & sleep 300 & wait\" timeout=2"}, 29)
    # line 30: THEN assert_output_contains text="timed out"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_output_contains, %{text: "timed out"}, %{file: "/home/wangbo/document/gong/docs/bdd/bash_edge.dsl", line: 30, raw: "THEN assert_output_contains text=\"timed out\""}, 30)
    # line 31: THEN assert_result_field field="timed_out" expected="true"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_result_field, %{expected: "true", field: "timed_out"}, %{file: "/home/wangbo/document/gong/docs/bdd/bash_edge.dsl", line: 31, raw: "THEN assert_result_field field=\"timed_out\" expected=\"true\""}, 31)
    _ctx = ctx
    :ok
  end

end
