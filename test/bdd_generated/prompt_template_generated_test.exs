# Generated by bdd_compiler from /home/wangbo/document/gong/docs/bdd/prompt_template.dsl. DO NOT EDIT.

defmodule Gong.BDD.Generated.PromptTemplateTest do
  use ExUnit.Case, async: false

  @moduletag :bdd_generated

  # Source: TEMPLATE-001
  @tag :template
  @tag :unit
  test "[TEMPLATE-001] 内置模板可获取" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "TEMPLATE-001"}
    # line 9: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 9, raw: "GIVEN create_temp_dir"}, 9)
    # line 10: WHEN init_prompt_templates
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :init_prompt_templates, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 10, raw: "WHEN init_prompt_templates"}, 10)
    # line 11: WHEN get_template name="code_review"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :get_template, %{name: "code_review"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 11, raw: "WHEN get_template name=\"code_review\""}, 11)
    # line 12: THEN assert_template_exists name="code_review"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_template_exists, %{name: "code_review"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 12, raw: "THEN assert_template_exists name=\"code_review\""}, 12)
    _ctx = ctx
    :ok
  end

  # Source: TEMPLATE-002
  @tag :template
  @tag :unit
  test "[TEMPLATE-002] 注册自定义模板" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "TEMPLATE-002"}
    # line 15: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 15, raw: "GIVEN create_temp_dir"}, 15)
    # line 16: WHEN init_prompt_templates
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :init_prompt_templates, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 16, raw: "WHEN init_prompt_templates"}, 16)
    # line 17: WHEN register_template name="my_template" content="请{{action}}以下内容：\n{{content}}"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :register_template, %{content: "请{{action}}以下内容：\\n{{content}}", name: "my_template"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 17, raw: "WHEN register_template name=\"my_template\" content=\"请{{action}}以下内容：\\n{{content}}\""}, 17)
    # line 18: WHEN get_template name="my_template"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :get_template, %{name: "my_template"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 18, raw: "WHEN get_template name=\"my_template\""}, 18)
    # line 19: THEN assert_template_exists name="my_template"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_template_exists, %{name: "my_template"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 19, raw: "THEN assert_template_exists name=\"my_template\""}, 19)
    # line 20: THEN assert_template_variables expected="action,content"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_template_variables, %{expected: "action,content"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 20, raw: "THEN assert_template_variables expected=\"action,content\""}, 20)
    _ctx = ctx
    :ok
  end

  # Source: TEMPLATE-003
  @tag :template
  @tag :unit
  test "[TEMPLATE-003] 渲染模板替换变量" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "TEMPLATE-003"}
    # line 23: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 23, raw: "GIVEN create_temp_dir"}, 23)
    # line 24: WHEN init_prompt_templates
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :init_prompt_templates, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 24, raw: "WHEN init_prompt_templates"}, 24)
    # line 25: WHEN render_template name="code_review" bindings="code:hello world"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :render_template, %{bindings: "code:hello world", name: "code_review"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 25, raw: "WHEN render_template name=\"code_review\" bindings=\"code:hello world\""}, 25)
    # line 26: THEN assert_rendered_content contains="hello world"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_rendered_content, %{contains: "hello world"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 26, raw: "THEN assert_rendered_content contains=\"hello world\""}, 26)
    _ctx = ctx
    :ok
  end

  # Source: TEMPLATE-004
  @tag :template
  @tag :unit
  test "[TEMPLATE-004] 获取不存在的模板" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "TEMPLATE-004"}
    # line 29: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 29, raw: "GIVEN create_temp_dir"}, 29)
    # line 30: WHEN init_prompt_templates
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :init_prompt_templates, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 30, raw: "WHEN init_prompt_templates"}, 30)
    # line 31: WHEN get_template_expect_error name="nonexistent"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :get_template_expect_error, %{name: "nonexistent"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 31, raw: "WHEN get_template_expect_error name=\"nonexistent\""}, 31)
    # line 32: THEN assert_template_error contains="not_found"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_template_error, %{contains: "not_found"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 32, raw: "THEN assert_template_error contains=\"not_found\""}, 32)
    _ctx = ctx
    :ok
  end

  # Source: TEMPLATE-005
  @tag :template
  @tag :unit
  test "[TEMPLATE-005] list 返回全部模板" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "TEMPLATE-005"}
    # line 39: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 39, raw: "GIVEN create_temp_dir"}, 39)
    # line 40: WHEN init_prompt_templates
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :init_prompt_templates, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 40, raw: "WHEN init_prompt_templates"}, 40)
    # line 41: WHEN register_template name="custom" content="自定义{{var}}"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :register_template, %{content: "自定义{{var}}", name: "custom"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 41, raw: "WHEN register_template name=\"custom\" content=\"自定义{{var}}\""}, 41)
    # line 42: THEN assert_template_list_count expected=4
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_template_list_count, %{expected: 4}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 42, raw: "THEN assert_template_list_count expected=4"}, 42)
    _ctx = ctx
    :ok
  end

  # Source: TEMPLATE-006
  @tag :template
  @tag :unit
  test "[TEMPLATE-006] 缺失变量保留占位符" do
    run_id = Gong.BDD.Instructions.V1.new_run_id()
    ctx = %{run_id: run_id, scenario_id: "TEMPLATE-006"}
    # line 45: GIVEN create_temp_dir
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :given, :create_temp_dir, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 45, raw: "GIVEN create_temp_dir"}, 45)
    # line 46: WHEN init_prompt_templates
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :init_prompt_templates, %{}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 46, raw: "WHEN init_prompt_templates"}, 46)
    # line 47: WHEN render_template name="code_review" bindings=""
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :when, :render_template, %{bindings: "", name: "code_review"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 47, raw: "WHEN render_template name=\"code_review\" bindings=\"\""}, 47)
    # line 48: THEN assert_rendered_content contains="{{code}}"
    ctx = Gong.BDD.Instructions.V1.run_step!(ctx, :then, :assert_rendered_content, %{contains: "{{code}}"}, %{file: "/home/wangbo/document/gong/docs/bdd/prompt_template.dsl", line: 48, raw: "THEN assert_rendered_content contains=\"{{code}}\""}, 48)
    _ctx = ctx
    :ok
  end

end
